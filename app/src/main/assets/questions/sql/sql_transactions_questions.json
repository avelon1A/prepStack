{
  "topicId": "sql_transactions",
  "questions": [
    {"id": "sql_trans_theory_1", "questionText": "What is a database transaction?", "type": "THEORY", "correctAnswer": "A transaction is a sequence of one or more SQL operations that are executed as a single unit of work. Either all operations are completed successfully (committed), or none are applied (rolled back) if any operation fails.", "explanation": "Transactions are essential for maintaining data integrity in a database, especially when multiple related changes need to be made together.", "difficulty": "EASY"},
    
    {"id": "sql_trans_theory_2", "questionText": "What are the ACID properties in database transactions?", "type": "THEORY", "correctAnswer": "ACID stands for: Atomicity (a transaction is all or nothing), Consistency (a transaction brings the database from one valid state to another), Isolation (concurrent transactions don't interfere with each other), Durability (once committed, transactions persist even in case of system failure).", "explanation": "ACID properties ensure that database transactions are processed reliably, maintaining data integrity even in case of errors, concurrent access, or system failures.", "difficulty": "MEDIUM"},
    
    {"id": "sql_trans_theory_3", "questionText": "Explain transaction isolation levels in SQL.", "type": "THEORY", "correctAnswer": "Transaction isolation levels control how transaction integrity is visible to other users and systems. Standard levels from least to most strict are: READ UNCOMMITTED, READ COMMITTED, REPEATABLE READ, and SERIALIZABLE. Each level prevents different phenomena: dirty reads, non-repeatable reads, and phantom reads.", "explanation": "Higher isolation levels provide more consistency but may reduce concurrency. The choice of isolation level depends on the specific application requirements for data integrity versus performance.", "codeExample": "-- Set isolation level (SQL Server)\nSET TRANSACTION ISOLATION LEVEL READ COMMITTED;\n\n-- Start a transaction\nBEGIN TRANSACTION;\n\n-- Perform operations\nUPDATE accounts SET balance = balance - 100 WHERE account_id = 1;\nUPDATE accounts SET balance = balance + 100 WHERE account_id = 2;\n\n-- Commit the transaction\nCOMMIT;", "difficulty": "HARD"},
    
    {"id": "sql_trans_theory_4", "questionText": "What is a deadlock in database transactions and how can it be prevented?", "type": "THEORY", "correctAnswer": "A deadlock occurs when two or more transactions are waiting for each other to release locks, resulting in a standstill. Prevention strategies include: consistent order of accessing tables, keeping transactions short, using appropriate isolation levels, deadlock detection and resolution mechanisms, and using timeouts.", "explanation": "Deadlocks are a common concurrency issue in multi-user database systems. While database systems typically have deadlock detection and will terminate one of the transactions, proper application design can minimize deadlock occurrence.", "difficulty": "HARD"},
    
    {"id": "sql_trans_theory_5", "questionText": "What is the difference between ROLLBACK and COMMIT in a transaction?", "type": "THEORY", "correctAnswer": "COMMIT permanently saves all changes made during the transaction. ROLLBACK undoes all changes made during the transaction, reverting the database to its state before the transaction began.", "explanation": "COMMIT and ROLLBACK are the two ways to end a transaction. COMMIT is used when all operations succeeded and the changes should be saved, while ROLLBACK is used when an error occurred and the changes should be discarded.", "codeExample": "-- Successful transaction\nBEGIN TRANSACTION;\nUPDATE accounts SET balance = balance - 100 WHERE account_id = 1;\nUPDATE accounts SET balance = balance + 100 WHERE account_id = 2;\nCOMMIT;\n\n-- Transaction with error handling\nBEGIN TRANSACTION;\nUPDATE accounts SET balance = balance - 100 WHERE account_id = 1;\n\n-- Check if account has sufficient funds\nIF (SELECT balance FROM accounts WHERE account_id = 1) < 0 THEN\n    ROLLBACK; -- Undo changes if insufficient funds\nELSE\n    UPDATE accounts SET balance = balance + 100 WHERE account_id = 2;\n    COMMIT;\nEND IF;", "difficulty": "EASY"}
  ]
}